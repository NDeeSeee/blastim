# Глоссарий: аннотация генома

Ключевые термины, концепции и инструменты, используемые в практикуме.

---

## Термины

### Биологические

| Термин | Определение |
|--------|------------|
| **ORF** (Open Reading Frame) | Открытая рамка считывания — участок ДНК между старт-кодоном (ATG) и стоп-кодоном. Потенциальный белок-кодирующий ген |
| **CDS** (Coding Sequence) | Кодирующая последовательность — подтверждённая или предсказанная ORF, которая транслируется в белок |
| **tRNA** | Транспортная РНК — переносит аминокислоты к рибосоме при трансляции |
| **rRNA** | Рибосомальная РНК — структурный и каталитический компонент рибосомы |
| **Домен** | Структурно и функционально независимый участок белка. Один белок может содержать несколько доменов |
| **Гомология** | Общее эволюционное происхождение двух последовательностей. Бывает или нет — не бывает «частичной гомологии» |
| **Ортологи** | Гомологи, разделившиеся при видообразовании. Обычно сохраняют функцию |
| **Паралоги** | Гомологи, возникшие при дупликации гена внутри одного генома. Могут приобрести новые функции |
| **Оперон** | Группа генов у прокариот, транскрибируемая как единый мРНК. Часто кодирует белки одного метаболического пути |
| **Гипотетический белок** | Предсказанный белок без подтверждённой функции — только вычислительное предсказание ORF |

### Биоинформатические

| Термин | Определение |
|--------|------------|
| **E-value** | Expected value — ожидаемое число случайных совпадений с таким же или лучшим score в базе данного размера. Чем меньше, тем надёжнее (1e-5 = хорошо, 1e-50 = отлично) |
| **Identity (%)** | Процент идентичных позиций в выравнивании. 30% identity ≈ граница «сумеречной зоны» (twilight zone), где гомология неоднозначна |
| **Coverage** | Доля длины запроса, покрытая выравниванием. Высокий identity + низкий coverage = совпал только домен, а не весь белок |
| **Bitscore** | Нормализованная оценка качества выравнивания, не зависящая от размера базы данных. Чем выше, тем лучше |
| **HMM** (Hidden Markov Model) | Скрытая марковская модель — статистическая модель семейства белков, учитывающая позиционные вероятности аминокислот. «Более честная» гомология, чем попарное выравнивание |
| **Profile HMM** | HMM, построенная по множественному выравниванию семейства белков. Каждая позиция имеет свои вероятности match/insert/delete |
| **Лестница доказательств** | Концепция: уверенность в аннотации растёт с числом независимых источников (ORF → гомология → домены → curated rules) |
| **Структурная аннотация** | Предсказание координат генов (CDS, tRNA, rRNA) на геноме. «Где гены?» |
| **Функциональная аннотация** | Присвоение функции предсказанным генам. «Что делает этот ген?» |

### Форматы данных

| Формат | Описание |
|--------|----------|
| **FASTA** | Текстовый формат для нуклеотидных/белковых последовательностей. Заголовок начинается с `>` |
| **GFF3** | General Feature Format — табулированный формат для геномных признаков (CDS, tRNA и т.д.) с 9 столбцами |
| **TSV** | Tab-Separated Values — таблица с разделителем-табуляцией |
| **FAA** | FASTA Amino Acids — файл белковых последовательностей (продукт Prokka) |
| **FFN** | FASTA Feature Nucleotides — нуклеотидные последовательности предсказанных CDS |

---

## Концепции

### Почему автоматическая аннотация ошибается

Автоматическая аннотация (Prokka, PGAP) основана на переносе информации от уже аннотированных геномов. Ошибки накапливаются:
- «Best hit» в BLAST не обязательно ортолог — может быть паралог с другой функцией
- Совпадение одного домена не означает совпадение всей функции белка
- Границы CDS могут быть предсказаны неточно (альтернативный старт-кодон, фреймшифт)
- «Hypothetical protein» часто просто означает «никто не проверял экспериментально»

### Identity, Coverage, E-value — три измерения

Одного показателя недостаточно:
- **Высокий identity + высокий coverage + низкий E-value** → надёжная аннотация
- **Высокий identity + низкий coverage** → совпал только домен или мотив, а не весь белок
- **Низкий identity + высокий coverage** → отдалённый гомолог (возможно, сохранена функция, но нужна осторожность)
- **Высокий E-value** → случайное совпадение, даже если identity высокий

### Домены vs полноразмерная гомология

Поиск по доменам (Pfam/HMMER) и поиск по гомологии (DIAMOND/BLAST) дают разные виды информации:
- **DIAMOND** находит похожие белки целиком — отвечает на вопрос «на какой известный белок похож мой?»
- **Pfam/HMMER** находит консервативные домены — отвечает на вопрос «какие функциональные модули есть в моём белке?»
- Комбинация обоих подходов даёт наиболее надёжную аннотацию

---

## Инструменты

### Prokka

| | |
|---|---|
| **Что делает** | Полная автоматическая аннотация прокариотического генома: предсказание генов (Prodigal), поиск tRNA (Aragorn), rRNA (Barrnap), функциональная аннотация по встроенным базам |
| **Вход** | FASTA-файл геномной сборки |
| **Выход** | GFF3, FAA, FFN, GBK, TSV и другие форматы |
| **Почему Prokka** | Быстрый, простой в запуске, широко используется. Для учебных целей — идеальный баланс скорости и качества |
| **Альтернативы** | **Bakta** — более современный, стандартизованный output. **PGAP** (NCBI) — индустриальный стандарт, но тяжёлый |
| **Ограничения** | Однопроходный, не обновляет аннотации итеративно. Качество зависит от встроенных баз данных |

### DIAMOND

| | |
|---|---|
| **Что делает** | Быстрый поиск гомологии белков (аналог BLAST, но в 100-1000x быстрее) |
| **Вход** | Файл запросов (FAA) + база данных (.dmnd) |
| **Выход** | Табулированная таблица попаданий (формат BLAST outfmt 6) |
| **Почему DIAMOND** | Скорость позволяет работать на занятии. Результаты практически идентичны BLAST |
| **Альтернативы** | **BLAST** (NCBI) — оригинал, медленнее. **MMseqs2** — ещё быстрее, но сложнее в интерпретации |
| **Ключевые столбцы** | `pident` (identity), `evalue`, `bitscore`, `length` (длина выравнивания), `stitle` (описание hit) |

### HMMER / hmmscan

| | |
|---|---|
| **Что делает** | Поиск консервативных доменов в белках с помощью профильных HMM |
| **Вход** | Файл белков (FAA) + база HMM (Pfam) |
| **Выход** | Таблица найденных доменов (domtblout) |
| **Почему HMMER** | Profile HMM чувствительнее попарного выравнивания — находит отдалённые гомологи |
| **Альтернативы** | **InterProScan** — объединяет множество баз (Pfam, SMART, CDD и др.), но тяжелее |
| **База Pfam** | Курированная коллекция ~20 000 семейств белковых доменов. Каждое семейство — это один profile HMM |

### Вспомогательные инструменты

| Инструмент | Назначение |
|------------|-----------|
| **seqkit** | Быстрая работа с FASTA/FASTQ: статистика, фильтрация, извлечение последовательностей |
| **csvkit** | Работа с табулированными данными в командной строке |
| **pigz** | Параллельный gzip — ускоряет сжатие/распаковку |
