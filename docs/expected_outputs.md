# Ожидаемые результаты

Какие файлы должны появиться и как выглядит «хороший» результат после успешного запуска на B. subtilis 168.

## Структура директории результатов

После `bash workflow/run_all.sh`:

```
outputs/run_YYYYMMDD_HHMMSS/
├── prokka/
│   ├── ANNOT.gff          ~12-15 МБ   Аннотированный геном (GFF3)
│   ├── ANNOT.faa          ~1.5 МБ     Предсказанные белки (FASTA)
│   ├── ANNOT.ffn          ~3.5 МБ     Нуклеотидные CDS (FASTA)
│   ├── ANNOT.fna          ~4.2 МБ     Входные контиги (переименованные)
│   ├── ANNOT.fsa          ~4.2 МБ     Контиги для депозита
│   ├── ANNOT.gbk          ~15 МБ      Формат GenBank
│   ├── ANNOT.log          разн.       Лог Prokka
│   ├── ANNOT.sqn          ~15 МБ      Формат Sequin
│   ├── ANNOT.tbl          ~2 МБ       Таблица признаков (Sequin)
│   ├── ANNOT.tsv          ~500 КБ     Таблица признаков (TSV)
│   └── ANNOT.txt          <1 КБ       Сводная статистика
├── diamond/
│   └── blastp_results.tsv ~5-20 МБ    Попадания DIAMOND blastp
└── hmmer/
    ├── hmmscan_domtblout.txt  ~1-5 МБ Таблица найденных доменов
    ├── hmmscan.log            разн.   Полный вывод hmmscan
    └── query_subset.faa       (только если использовался --max-proteins)
```

## Ожидаемые значения (B. subtilis 168, приблизительно)

### Prokka

| Тип признака      | Ожидаемое количество |
|-------------------|---------------------|
| CDS               | 4 200 - 4 400       |
| tRNA              | 85 - 90             |
| rRNA              | 10 - 30             |
| tmRNA             | 1                   |
| Всего генов       | ~4 300 - 4 500      |

### DIAMOND

| Метрика                                   | Ожидаемое значение |
|-------------------------------------------|-------------------|
| Всего попаданий (до 5 на запрос)          | 15 000 - 20 000   |
| Уникальных белков с попаданиями           | 3 000 - 4 000     |
| Доля попаданий                            | 70% - 90%         |
| Медиана % идентичности (лучшие попадания) | 40% - 60%         |

### hmmscan (подмножество, ~200 HMM)

| Метрика                    | Ожидаемое значение |
|----------------------------|-------------------|
| Всего найденных доменов    | 1 000 - 3 000     |
| Белков с доменами          | 800 - 2 000       |
| Уникальных доменов         | 80 - 180          |

### hmmscan (полная Pfam-A)

| Метрика                    | Ожидаемое значение |
|----------------------------|-------------------|
| Всего найденных доменов    | 4 000 - 6 000     |
| Белков с доменами          | 2 500 - 3 500     |
| Уникальных доменов         | 800 - 1 500       |

### Лестница доказательств

| Категория                      | Ожидаемое (подмнож. Pfam) |
|--------------------------------|--------------------------|
| И DIAMOND, и домен             | 800 - 2 000              |
| Только DIAMOND                 | 1 000 - 2 500            |
| Только домен                   | 100 - 500                |
| Без аннотации (гипотетические) | 300 - 1 000              |

## Как выглядит «хороший» результат

- Prokka завершается без ошибок и находит > 4 000 CDS.
- DIAMOND находит попадания для 70%+ белков.
- hmmscan (подмножество) определяет домены у 20-50% белков.
- Скрипт проверки качества показывает правдоподобное распределение длин белков (медиана ~250-350 а.к.).
- Лестница доказательств показывает градиент: большинство белков имеют хотя бы какое-то подтверждение.
- Очень мало белков (< 5%) должны быть очень короткими (< 50 а.к.) -- если их много, Prokka мог использовать слишком мягкие настройки предсказания ORF.

## Тревожные признаки

- **0 предсказанных CDS**: Файл сборки может быть пустым или в неправильном формате.
- **Нет попаданий DIAMOND**: База данных могла быть построена некорректно. Проверьте `diamond dbinfo`.
- **hmmscan завершается мгновенно**: База HMM не проиндексирована. Запустите `hmmpress`.
- **Доля попаданий < 50%**: База данных может быть слишком маленькой или не для той группы организмов. Проверьте подмножество Swiss-Prot.
- **Prokka сообщает «0 contigs»**: Файл может иметь окончания строк Windows. Исправьте с помощью `dos2unix`.
