# Ожидаемые результаты

Какие файлы должны появиться и как выглядит «хороший» результат после успешного запуска на B. subtilis 168.

## Структура директории результатов

После `bash workflow/run_all.sh`:

```
outputs/run_YYYYMMDD_HHMMSS/
└── variants/
    ├── raw.vcf.gz             ~1-3 МБ    Все вызванные варианты
    ├── raw.vcf.gz.tbi         <100 КБ    Tabix-индекс
    ├── raw.stats.txt          ~50 КБ     Статистика bcftools stats
    ├── filtered.vcf.gz        ~0.5-2 МБ  Отфильтрованные варианты
    ├── filtered.vcf.gz.tbi    <100 КБ    Tabix-индекс
    ├── filtered.stats.txt     ~50 КБ     Статистика bcftools stats
    └── example_variants.txt   <1 КБ      3 примера для обсуждения
```

## Ожидаемые значения (B. subtilis 168, wgsim ~50x)

### Общая статистика

| Метрика | Ожидаемое значение |
|---------|-------------------|
| Всего вариантов (raw) | 3 000 - 5 000 |
| SNP | 2 500 - 4 000 |
| Indel | 300 - 800 |
| Ti/Tv ratio | 2.0 - 2.5 |

### После фильтрации (QUAL >= 20, DP >= 5, DP <= 200)

| Метрика | Ожидаемое значение |
|---------|-------------------|
| Варианты прошедшие фильтр | 70% - 85% |
| SNP (filtered) | 2 000 - 3 500 |
| Indel (filtered) | 200 - 600 |
| Ti/Tv ratio (filtered) | 2.0 - 2.5 |

### Покрытие BAM

| Метрика | Ожидаемое значение |
|---------|-------------------|
| Среднее покрытие | ~50x |
| Процент выравненных прочтений | > 99% |
| Properly paired | > 98% |

## Как выглядит «хороший» результат

- freebayes завершается без ошибок и находит > 2000 вариантов.
- Ti/Tv ratio для SNP находится в диапазоне 2.0-2.5 (типично для реальных замен).
- 70-85% вариантов проходят базовые фильтры.
- Среди отфильтрованных вариантов есть как SNP, так и indel.
- Пример "confident SNP" имеет QUAL > 100 и DP > 20.
- Пример "borderline variant" имеет QUAL < 30 или DP < 10.

## Тревожные признаки

- **0 вариантов**: BAM пустой или референс не совпадает. Проверьте `samtools flagstat`.
- **> 10 000 вариантов**: Возможно, слишком высокое покрытие или другие параметры wgsim.
- **Ti/Tv < 1.5**: Много ложноположительных вариантов — проверьте данные.
- **0 indels**: freebayes мог не отработать корректно — проверьте версию.
- **bgzip fails**: Файл сжат обычным gzip вместо bgzip. Пересожмите.
- **Все генотипы 0/1**: Плоидность не установлена в 1 — проверьте `PLOIDY` в config.sh.
